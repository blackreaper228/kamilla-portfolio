class f{constructor(){this.imageExtensions=[".jpg",".jpeg",".png",".webp",".gif"],this.galleries=new Map}clearCache(e=null){e?(this.galleries.delete(e),console.log(`üóëÔ∏è –ö—ç—à –≥–∞–ª–µ—Ä–µ–∏ ${e} –æ—á–∏—â–µ–Ω`)):(this.galleries.clear(),console.log("üóëÔ∏è –í–µ—Å—å –∫—ç—à –≥–∞–ª–µ—Ä–µ–π –æ—á–∏—â–µ–Ω"))}async discoverImages(e){try{const t=await this.getImageListFromServer(e);if(t.length>0)return t}catch{}const o=await this.discoverByPatterns(e),a=[];for(const t of o)await this.imageExists(t)&&a.push(t);return a}async getImageListFromServer(e){try{const o=await fetch(`/images/${e}/`,{method:"GET",headers:{Accept:"application/json, text/html"}});if(o.ok&&o.status===200){const a=await o.text();if(a.includes("<a href=")&&a.includes(".jpg")){const t=this.parseFileListFromHTML(a,e);if(t.length>0)return t}}}catch{}return[]}parseFileListFromHTML(e,o){const a=[],t=`/images/${o}/`,s=/<a href="([^"]+)"/g;let n;for(;(n=s.exec(e))!==null;){const i=n[1];this.isImageFile(i)&&!i.includes("README")&&a.push(t+i)}return a.sort(this.naturalSort)}isImageFile(e){const o=e.toLowerCase().split(".").pop();return this.imageExtensions.some(a=>a.slice(1)===o)}naturalSort(e,o){return e.localeCompare(o,void 0,{numeric:!0,sensitivity:"base"})}async discoverByPatterns(e){const o=[],a=`/images/${e}/`,t=[{name:n=>`${e}_${String(n).padStart(2,"0")}`,ext:".jpg"},{name:n=>`${e}${String(n).padStart(2,"0")}`,ext:".jpg"},{name:n=>`${n}`,ext:".jpg"}];for(const n of t){const i=d=>n.name(d)+n.ext,r=await this.checkPatternSmart(a,i,e);if(r.length>0)return r}const s=[n=>`${e}_${n}`,n=>`${e}${n}`,n=>`img_${String(n).padStart(2,"0")}`,n=>`${String(n).padStart(2,"0")}`];for(const n of s)for(const i of this.imageExtensions){const r=l=>n(l)+i,d=await this.checkPatternSmart(a,r,e);if(d.length>0)return d}return o}getCategoryLimit(e){return{fashion:9,"e-commerce":10,events:10,magazine:10,reportage:10,personal:10,interior:10,food:10,product:10,bts:10}[e]||10}async checkPatternSmart(e,o,a){const t=[];let s=1;const n=this.getCategoryLimit(a);for(;s<=n;){const i=e+o(s);if(await this.imageExists(i))t.push(i);else break;s++}return t}async imageExists(e){try{return(await fetch(e,{method:"HEAD"})).ok}catch{return!1}}getCategoryDisplayName(e){return{fashion:"photos","e-commerce":"photos",events:"photos",magazine:"photos",reportage:"photos",personal:"photos",interior:"photos",food:"photos",product:"photos",bts:"photos"}[e]||e.charAt(0).toUpperCase()+e.slice(1)}createCategoryDropdown(e){const o=[{key:"fashion",label:"fashion"},{key:"e-commerce",label:"e-commerce"},{key:"events",label:"events"},{key:"magazine",label:"magazine"},{key:"reportage",label:"reportage"},{key:"personal",label:"personal"},{key:"interior",label:"interior"},{key:"food",label:"food"},{key:"product",label:"product"},{key:"bts",label:"bts"}],a=document.createElement("div");a.className="dropdown-wrapper";const t=document.createElement("div");t.className="custom-dropdown";const s=document.createElement("button");s.type="button",s.className="custom-dropdown-button",s.setAttribute("aria-haspopup","listbox"),s.setAttribute("aria-expanded","false");const n=o.find(l=>l.key===e);s.textContent=n?n.label:e;const i=document.createElement("span");i.className="custom-dropdown-arrow",i.textContent="‚Üì",s.appendChild(i);const r=document.createElement("ul");r.className="custom-dropdown-list",r.setAttribute("role","listbox"),o.forEach(l=>{const c=document.createElement("li");c.className="custom-dropdown-item",c.setAttribute("role","option"),l.key===e&&c.setAttribute("aria-selected","true"),c.textContent=l.label,c.addEventListener("click",m=>{m.stopPropagation(),window.location.href=`/pages/photos/${l.key}.html`}),r.appendChild(c)});const d=()=>{const l=t.classList.toggle("open");s.setAttribute("aria-expanded",String(l))};return s.addEventListener("click",l=>{l.stopPropagation(),d()}),document.addEventListener("click",()=>{t.classList.remove("open"),s.setAttribute("aria-expanded","false")}),t.appendChild(s),t.appendChild(r),a.appendChild(t),a}createGalleryHTML(e,o){const a=[...new Set(e)],t=document.createElement("div");t.className="photo-gallery",t.setAttribute("data-category",o);const s=document.createElement("div");s.className="gallery-header";const n=document.createElement("h1");n.className="gallery-title",n.textContent=this.getCategoryDisplayName(o),s.appendChild(n);const i=this.createCategoryDropdown(o);s.appendChild(i),t.appendChild(s);const r=document.createElement("div");return r.className="photos-grid",a.forEach((d,l)=>{const c=document.createElement("div");c.className="photo-item";const m=document.createElement("img");m.src=d,m.alt=`${o} photo ${l+1}`,m.loading="lazy",m.className="gallery-image",m.addEventListener("error",()=>{c.style.display="none"}),m.addEventListener("click",()=>this.openLightbox(d,a,l)),c.appendChild(m),r.appendChild(c)}),t.appendChild(r),t}openLightbox(e,o,a){const t=document.createElement("div");t.className="lightbox";const s=document.createElement("div");s.className="lightbox-content";const n=document.createElement("span");n.className="lightbox-close",n.innerHTML="&times;";const i=document.createElement("img");i.className="lightbox-image",i.src=e,i.alt="Enlarged photo";const r=document.createElement("div");r.className="lightbox-nav";const d=document.createElement("button");d.className="lightbox-prev",d.innerHTML="‚Äπ";const l=document.createElement("button");l.className="lightbox-next",l.innerHTML="‚Ä∫",r.appendChild(d),r.appendChild(l),t.appendChild(n),s.appendChild(i),s.appendChild(r),t.appendChild(s);const c=p=>{p>=0&&p<o.length&&(a=p,i.src=o[a],d.style.opacity=a>0?"1":"0.3",l.style.opacity=a<o.length-1?"1":"0.3",d.style.pointerEvents=a>0?"auto":"none",l.style.pointerEvents=a<o.length-1?"auto":"none")};c(a),d.addEventListener("click",p=>{p.stopPropagation(),c(a-1)}),l.addEventListener("click",p=>{p.stopPropagation(),c(a+1)});const m=p=>{p.key==="ArrowLeft"?c(a-1):p.key==="ArrowRight"?c(a+1):p.key==="Escape"&&(t.remove(),document.removeEventListener("keydown",m))};document.addEventListener("keydown",m),n.addEventListener("click",()=>{t.remove(),document.removeEventListener("keydown",m)}),t.addEventListener("click",p=>{p.target===t&&(t.remove(),document.removeEventListener("keydown",m))}),document.body.appendChild(t)}async loadGallery(e,o="gallery-container"){if(console.log(`Loading: ${e}`),!window.location.hostname.includes("localhost")&&!window.location.hostname.includes("127.0.0.1")&&this.galleries.has(e))return console.log(`üì¶ –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≥–∞–ª–µ—Ä–µ—é –¥–ª—è ${e}`),this.galleries.get(e);try{const t=document.getElementById(o);if(!t){console.error(`‚ùå –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å ID "${o}" –Ω–µ –Ω–∞–π–¥–µ–Ω`);return}t.innerHTML='<div class="gallery-loader">Loading...</div>';const s=await this.discoverImages(e);if(s.length===0){t.innerHTML='<div class="gallery-empty">üì∑ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';return}const n=this.createGalleryHTML(s,e);return t.innerHTML="",t.appendChild(n),this.galleries.set(e,s),console.log(`‚úÖ –ì–∞–ª–µ—Ä–µ—è "${e}" —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!`),s}catch(t){console.error(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∞–ª–µ—Ä–µ–∏ ${e}:`,t);const s=document.getElementById(o);s&&(s.innerHTML='<div class="gallery-error">‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π</div>')}}}const g=new f;async function u(h,e="gallery-container"){return await g.loadGallery(h,e)}function v(){const e=window.location.pathname.match(/\/photos\/([^/]+)\.html/);if(e){const o=e[1];console.log(`üéØ –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –≥–∞–ª–µ—Ä–µ–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: ${o}`),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>u(o)):u(o)}}function y(h=null){return g.clearCache(h)}window.clearGalleryCache=y;window.photoGallery=g;export{v as a};
