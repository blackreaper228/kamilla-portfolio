class f{constructor(){this.imageExtensions=[".jpg",".jpeg",".png",".webp",".gif"],this.galleries=new Map}clearCache(e=null){e?(this.galleries.delete(e),console.log(`üóëÔ∏è –ö—ç—à –≥–∞–ª–µ—Ä–µ–∏ ${e} –æ—á–∏—â–µ–Ω`)):(this.galleries.clear(),console.log("üóëÔ∏è –í–µ—Å—å –∫—ç—à –≥–∞–ª–µ—Ä–µ–π –æ—á–∏—â–µ–Ω"))}async discoverImages(e){try{const t=await this.getImageListFromServer(e);if(t.length>0)return t}catch{}const n=await this.discoverByPatterns(e),a=[];for(const t of n)await this.imageExists(t)&&a.push(t);return a}async getImageListFromServer(e){try{const n=await fetch(`/images/${e}/`,{method:"GET",headers:{Accept:"application/json, text/html"}});if(n.ok&&n.status===200){const a=await n.text();if(a.includes("<a href=")&&a.includes(".jpg")){const t=this.parseFileListFromHTML(a,e);if(t.length>0)return t}}}catch{}return[]}parseFileListFromHTML(e,n){const a=[],t=`/images/${n}/`,s=/<a href="([^"]+)"/g;let o;for(;(o=s.exec(e))!==null;){const i=o[1];this.isImageFile(i)&&!i.includes("README")&&a.push(t+i)}return a.sort(this.naturalSort)}isImageFile(e){const n=e.toLowerCase().split(".").pop();return this.imageExtensions.some(a=>a.slice(1)===n)}naturalSort(e,n){return e.localeCompare(n,void 0,{numeric:!0,sensitivity:"base"})}async discoverByPatterns(e){const n=[],a=`/images/${e}/`,t=[{name:o=>`${e}_${String(o).padStart(2,"0")}`,ext:".jpg"},{name:o=>`${e}${String(o).padStart(2,"0")}`,ext:".jpg"},{name:o=>`${o}`,ext:".jpg"}];for(const o of t){const i=r=>o.name(r)+o.ext,l=await this.checkPatternSmart(a,i,e);if(l.length>0)return l}const s=[o=>`${e}_${o}`,o=>`${e}${o}`,o=>`img_${String(o).padStart(2,"0")}`,o=>`${String(o).padStart(2,"0")}`];for(const o of s)for(const i of this.imageExtensions){const l=h=>o(h)+i,r=await this.checkPatternSmart(a,l,e);if(r.length>0)return r}return n}getCategoryLimit(e){return{fashion:9,"e-commerce":10,events:10,magazine:10,reportage:10,personal:10,interior:10,food:10,product:10,bts:10}[e]||10}async checkPatternSmart(e,n,a){const t=[];let s=1;const o=this.getCategoryLimit(a);for(;s<=o;){const i=e+n(s);if(await this.imageExists(i))t.push(i);else break;s++}return t}async imageExists(e){try{return(await fetch(e,{method:"HEAD"})).ok}catch{return!1}}getCategoryDisplayName(e){return{fashion:"photos","e-commerce":"photos",events:"photos",magazine:"photos",reportage:"photos",personal:"photos",interior:"photos",food:"photos",product:"photos",bts:"photos"}[e]||e.charAt(0).toUpperCase()+e.slice(1)}createCategoryDropdown(e){const n=[{key:"fashion",label:"fashion"},{key:"e-commerce",label:"e-commerce"},{key:"events",label:"events"},{key:"magazine",label:"magazine"},{key:"reportage",label:"reportage"},{key:"personal",label:"personal"},{key:"interior",label:"interior"},{key:"food",label:"food"},{key:"product",label:"product"},{key:"bts",label:"bts"}],a=document.createElement("div");a.className="dropdown-wrapper";const t=document.createElement("select");return t.className="category-dropdown",t.value=e,n.forEach(s=>{const o=document.createElement("option");o.value=s.key,o.textContent=s.label,o.selected=s.key===e,t.appendChild(o)}),t.addEventListener("change",s=>{const o=s.target.value;window.location.href=`/pages/photos/${o}.html`}),a.appendChild(t),a}createGalleryHTML(e,n){const a=[...new Set(e)],t=document.createElement("div");t.className="photo-gallery",t.setAttribute("data-category",n);const s=document.createElement("div");s.className="gallery-header";const o=document.createElement("h1");o.className="gallery-title",o.textContent=this.getCategoryDisplayName(n),s.appendChild(o);const i=this.createCategoryDropdown(n);s.appendChild(i),t.appendChild(s);const l=document.createElement("div");return l.className="photos-grid",a.forEach((r,h)=>{const m=document.createElement("div");m.className="photo-item";const c=document.createElement("img");c.src=r,c.alt=`${n} photo ${h+1}`,c.loading="lazy",c.className="gallery-image",c.addEventListener("error",()=>{m.style.display="none"}),c.addEventListener("click",()=>this.openLightbox(r,a,h)),m.appendChild(c),l.appendChild(m)}),t.appendChild(l),t}openLightbox(e,n,a){const t=document.createElement("div");t.className="lightbox";const s=document.createElement("div");s.className="lightbox-content";const o=document.createElement("span");o.className="lightbox-close",o.innerHTML="&times;";const i=document.createElement("img");i.className="lightbox-image",i.src=e,i.alt="Enlarged photo";const l=document.createElement("div");l.className="lightbox-nav";const r=document.createElement("button");r.className="lightbox-prev",r.innerHTML="‚Äπ";const h=document.createElement("span");h.className="lightbox-counter",h.textContent=`${a+1} / ${n.length}`;const m=document.createElement("button");m.className="lightbox-next",m.innerHTML="‚Ä∫",l.appendChild(r),l.appendChild(h),l.appendChild(m),s.appendChild(o),s.appendChild(i),s.appendChild(l),t.appendChild(s);const c=d=>{d>=0&&d<n.length&&(a=d,i.src=n[a],h.textContent=`${a+1} / ${n.length}`,r.style.opacity=a>0?"1":"0.3",m.style.opacity=a<n.length-1?"1":"0.3",r.style.pointerEvents=a>0?"auto":"none",m.style.pointerEvents=a<n.length-1?"auto":"none")};c(a),r.addEventListener("click",d=>{d.stopPropagation(),c(a-1)}),m.addEventListener("click",d=>{d.stopPropagation(),c(a+1)});const g=d=>{d.key==="ArrowLeft"?c(a-1):d.key==="ArrowRight"?c(a+1):d.key==="Escape"&&(t.remove(),document.removeEventListener("keydown",g))};document.addEventListener("keydown",g),o.addEventListener("click",()=>{t.remove(),document.removeEventListener("keydown",g)}),t.addEventListener("click",d=>{d.target===t&&(t.remove(),document.removeEventListener("keydown",g))}),document.body.appendChild(t)}async loadGallery(e,n="gallery-container"){if(console.log(`üîç –ó–∞–≥—Ä—É–∂–∞–µ–º –≥–∞–ª–µ—Ä–µ—é –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: ${e}`),!window.location.hostname.includes("localhost")&&!window.location.hostname.includes("127.0.0.1")&&this.galleries.has(e))return console.log(`üì¶ –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≥–∞–ª–µ—Ä–µ—é –¥–ª—è ${e}`),this.galleries.get(e);try{const t=document.getElementById(n);if(!t){console.error(`‚ùå –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å ID "${n}" –Ω–µ –Ω–∞–π–¥–µ–Ω`);return}t.innerHTML='<div class="gallery-loader">üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏...</div>';const s=await this.discoverImages(e);if(s.length===0){t.innerHTML='<div class="gallery-empty">üì∑ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';return}const o=this.createGalleryHTML(s,e);return t.innerHTML="",t.appendChild(o),this.galleries.set(e,s),console.log(`‚úÖ –ì–∞–ª–µ—Ä–µ—è "${e}" —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!`),s}catch(t){console.error(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∞–ª–µ—Ä–µ–∏ ${e}:`,t);const s=document.getElementById(n);s&&(s.innerHTML='<div class="gallery-error">‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π</div>')}}}const u=new f;async function y(p,e="gallery-container"){return await u.loadGallery(p,e)}function E(){const e=window.location.pathname.match(/\/photos\/([^/]+)\.html/);if(e){const n=e[1];console.log(`üéØ –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –≥–∞–ª–µ—Ä–µ–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: ${n}`),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>y(n)):y(n)}}function v(p=null){return u.clearCache(p)}window.clearGalleryCache=v;window.photoGallery=u;export{E as a};
